'use client';

// import { useTranslations } from 'next-intl';
import { useContext } from 'react';

import { AuctionTypeBadge, CategoryBadge, EndingSoonBadge } from '@/components/Badge';
import { Id } from '@/components/Id';
import { Switch } from '@/components/SwitchCase';
import { WithSkeleton } from '@/components/WithSkeleton';
import { SingleAuctionContext } from '@/contexts';
import { Bids } from '@/pages/marketplace/auction/[auctionId]/(details)/@details/Bids';
import { Properties } from '@/pages/marketplace/auction/[auctionId]/(details)/@details/Properties';
import { Winnings } from '@/pages/marketplace/auction/[auctionId]/(details)/@details/Winnings';
import {
	ActionIcon,
	Anchor,
	Avatar,
	Breadcrumbs,
	Group,
	Skeleton,
	Stack,
	Text,
	Title,
} from '@mantine/core';
import { IconBookmark, IconChevronRight, IconShare } from '@tabler/icons-react';

import classes from './styles.module.css';

export default function Details() {
	// const t = useTranslations();
	const auction = useContext(SingleAuctionContext);

	return (
		<Stack className={classes.root}>
			<Stack className={`${classes.details} ${classes.section}`}>
				<Group className={classes.row}>
					<Switch value={auction.isLoading}>
						<Switch.True>
							<Breadcrumbs
								separator={<IconChevronRight size={14} />}
								classNames={{
									root: classes.breadcrumbs,
									separator: classes.separator,
								}}
							>
								<Skeleton width={80} height={14} visible />
								<Skeleton width={80} height={14} visible />
								<Skeleton width={80} height={14} visible />
							</Breadcrumbs>
						</Switch.True>
						<Switch.False>
							<Breadcrumbs
								separator={<IconChevronRight size={14} />}
								classNames={{
									root: classes.breadcrumbs,
									separator: classes.separator,
								}}
							>
								<Anchor href="/marketplace">Marketplace</Anchor>
								<Anchor>Industry</Anchor>
								<Anchor>Flare Gas Burning</Anchor>
							</Breadcrumbs>
						</Switch.False>
					</Switch>
					<Group className={classes.cell}>
						<ActionIcon className={classes.action} variant="outline">
							<IconBookmark size={14} />
						</ActionIcon>
						<ActionIcon className={classes.action} variant="outline">
							<IconShare size={14} />
						</ActionIcon>
					</Group>
				</Group>
				<WithSkeleton loading={auction.isLoading} width={360} height={40}>
					<Title className={classes.title}>Flare Gas Burning</Title>
				</WithSkeleton>
				<Group className={classes.row}>
					<Group className={classes.cell}>
						<CategoryBadge category={'industry'} loading={auction.isLoading} />
						<AuctionTypeBadge type={auction.data.type} loading={auction.isLoading} />
					</Group>
					<Group className={classes.cell}>
						<EndingSoonBadge auction={auction.data} />
					</Group>
				</Group>
				<Switch value={auction.isLoading}>
					<Switch.True>
						<Stack className="gap-2">
							<Skeleton height={16} visible />
							<Skeleton height={16} visible />
							<Skeleton height={16} visible />
						</Stack>
					</Switch.True>
					<Switch.False>
						<Text className={classes.description}>
							{/* TODO: use description from backend only once auction descriptions are standardized */}
							{auction.data.description ||
								'This permit grants the owning company the right to emit a specified amount of polluting gases generated by flare gas burning. This includes gases such as carbon dioxide (CO2), methane (CH4), and other pollutants.'}
						</Text>
					</Switch.False>
				</Switch>
				<Group className={classes.row}>
					<Group className={classes.owner}>
						<WithSkeleton loading={auction.isLoading} width={40} height={40} circle>
							<Avatar
								className={classes.avatar}
								name={auction.data.owner && auction.data.owner.name}
							/>
						</WithSkeleton>
						<WithSkeleton loading={auction.isLoading} width={160} height={24}>
							<Anchor
								className={classes.link}
								href={`/marketplace/firm/${auction.data.ownerId}`}
							>
								{auction.data.owner && auction.data.owner.name}
							</Anchor>
						</WithSkeleton>
					</Group>
					<WithSkeleton loading={auction.isLoading} width={260} height={14}>
						<Id className={classes.id} value={auction.data.id} variant="industry" />
					</WithSkeleton>
				</Group>
			</Stack>

			<Properties />
			<Winnings />
			<Bids />
		</Stack>
	);
}
